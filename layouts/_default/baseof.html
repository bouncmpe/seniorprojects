{{- /* Check Hugo version */ -}}
{{- $OLDEST_SUPPORTED_HUGO_VERSION := "0.83.0" -}}
{{- if lt hugo.Version $OLDEST_SUPPORTED_HUGO_VERSION -}}
    {{- errorf "\n\nHugo version is too low.\n\nCurrent Hugo version is %v, the oldest supported version is %v.\nCheck out https://gohugo.io/getting-started/installing/#upgrade-hugo for upgrading guide\n\n" hugo.Version $OLDEST_SUPPORTED_HUGO_VERSION -}}
{{- end -}}

{{- /* Check Hugo extend */ -}}
{{- if eq hugo.IsExtended false -}}
    {{- warnf "\n\nThe Hugo Extended version is necessary for SCSS support." -}}
{{- end -}}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>{{- block "title" . }}{{ .Site.Title }}{{ end -}}</title>
    <meta name="description" content="{{ .Summary | default .Site.Title }}">
    <link rel="shortcut icon" type="image/x-icon" href="{{ relURL "favicon.ico" }}" />
    <link rel="icon" type="image/png" sizes="32x32" href="{{ relURL "favicon-32x32.png" }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ relURL "favicon-16x16.png" }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ relURL "apple-touch-icon.png" }}">
    <link rel="canonical" href="{{ .Permalink }}" />
    {{- if .PrevInSection -}}
        <link rel="prev" href="{{ .PrevInSection.Permalink }}" />
    {{- end -}}
    {{- if .NextInSection -}}
        <link rel="next" href="{{ .NextInSection.Permalink }}" />
    {{- end -}}

    {{ $options := dict "enableSourceMap" true "includePaths" (slice "node_modules") }}
    {{ if hugo.IsProduction}}
        {{ $options := dict "enableSourceMap" false "outputStyle" "compressed" "includePaths" (slice "node_modules") }}
    {{ end }}
    {{ $styles := resources.Get "scss/styles.scss" }}
    {{ $styles = $styles | resources.ToCSS $options }}
    {{ if hugo.IsProduction }}
        {{ $styles = $styles | fingerprint }}
    {{ end }}
    <style type="text/CSS">
        {{ $styles.Content | safeCSS }}
    </style>
</head>

<body data-bs-theme="light">
    <div class="wrapper">
        {{- partial "header.html" . -}}
        <main class="main">
            <div class="container-lg">
                {{- block "content" . }}{{ end -}}
                {{ partial "search-modal.html" }}
            </div>
        </main>
        {{- partial "footer.html" . -}}
    </div>

    {{ $js := resources.Get "js/index.js" }}
    {{ $params := dict }}
    {{ $sourceMap := cond hugo.IsProduction "" "inline" }}
    {{ $opts := dict "sourceMap" $sourceMap "minify" hugo.IsProduction "target" "es2018" "params" $params }}
    {{ $js = $js | js.Build $opts }}
    {{ if hugo.IsProduction }}
        {{ $js = $js | fingerprint }}
    {{ end }}  
    <script src="{{ $js.RelPermalink }}" {{ if hugo.IsProduction }}integrity="{{ $js.Data.Integrity }}"{{ end }} defer></script>
</body>

</html>